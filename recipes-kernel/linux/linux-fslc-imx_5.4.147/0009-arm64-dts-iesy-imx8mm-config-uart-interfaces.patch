From 0218f28a3c1893f9e83371ee37143e67726b12ed Mon Sep 17 00:00:00 2001
From: Dominik Poggel <pog@iesy.com>
Date: Mon, 16 Jan 2023 10:04:17 +0100
Subject: [PATCH 9/9] arm64: dts: iesy: imx8mm: config uart interfaces

---
 .../boot/dts/iesy/iesy-imx8mm-eva-mi.dts      | 43 ++++++++++++++-----
 1 file changed, 33 insertions(+), 10 deletions(-)

diff --git a/arch/arm64/boot/dts/iesy/iesy-imx8mm-eva-mi.dts b/arch/arm64/boot/dts/iesy/iesy-imx8mm-eva-mi.dts
index 58a33d042765..338f72087e74 100755
--- a/arch/arm64/boot/dts/iesy/iesy-imx8mm-eva-mi.dts
+++ b/arch/arm64/boot/dts/iesy/iesy-imx8mm-eva-mi.dts
@@ -26,7 +26,7 @@
 	};
 
 	chosen {
-		stdout-path = &uart2;
+		stdout-path = &uart3;
 	};
 
 	leds {
@@ -191,10 +191,19 @@
 	status = "okay";
 };
 
+&uart1 { /* UART C */
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_uart1>;
+	status = "okay";
+};
+
 &uart2 { /* UART B */
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_uart2>;
 	status = "okay";
+	cts-gpios = <&gpio5 28 GPIO_ACTIVE_LOW>;
+	rts-gpios = <&gpio5 29 GPIO_ACTIVE_LOW>;
+	uart-has-rtscts;
 };
 
 &uart3 { /* UART Console */
@@ -203,11 +212,14 @@
 	status = "okay";
 };
 
-// &uart4 { /* UART A */ //Anpassung im ATF n√∂tig
-// 	pinctrl-names = "default";
-// 	pinctrl-0 = <&pinctrl_uart4>;
-// 	status = "okay";
-// };
+&uart4 { /* UART A */
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_uart4>;
+	status = "okay";
+	cts-gpios = <&gpio5 12 GPIO_ACTIVE_LOW>;
+	rts-gpios = <&gpio5 9 GPIO_ACTIVE_LOW>;
+	uart-has-rtscts;
+};
 
 // &usbotg1 {
 // 	dr_mode = "otg";
@@ -554,10 +566,19 @@
 		>;
 	};
 
+	pinctrl_uart1: uart1grp {
+		fsl,pins = <
+			MX8MM_IOMUXC_UART1_RXD_UART1_DCE_RX	0x140
+			MX8MM_IOMUXC_UART1_TXD_UART1_DCE_TX	0x140
+		>;
+	};
+
 	pinctrl_uart2: uart2grp {
 		fsl,pins = <
-			MX8MM_IOMUXC_UART2_RXD_UART2_DCE_RX	0x140
-			MX8MM_IOMUXC_UART2_TXD_UART2_DCE_TX	0x140
+			MX8MM_IOMUXC_UART2_RXD_UART2_DCE_RX		0x140
+			MX8MM_IOMUXC_UART2_TXD_UART2_DCE_TX		0x140
+			MX8MM_IOMUXC_UART4_RXD_UART2_DCE_CTS_B	0x140
+			MX8MM_IOMUXC_UART4_TXD_UART2_DCE_RTS_B	0x140
 		>;
 	};
 
@@ -570,8 +591,10 @@
 
 	pinctrl_uart4: uart4grp {
 		fsl,pins = <
-			MX8MM_IOMUXC_ECSPI2_SCLK_UART4_DCE_RX 0x140
-			MX8MM_IOMUXC_ECSPI2_MOSI_UART4_DCE_TX 0x140
+			MX8MM_IOMUXC_ECSPI2_SCLK_UART4_DCE_RX 		0x140
+			MX8MM_IOMUXC_ECSPI2_MOSI_UART4_DCE_TX 		0x140
+			MX8MM_IOMUXC_ECSPI2_MISO_UART4_DCE_CTS_B	0x140
+			MX8MM_IOMUXC_ECSPI2_SS0_UART4_DCE_RTS_B		0x140
 		>;
 	};
 
-- 
2.30.2

